ATAC-Seq pipeline
--------------------------------------

This page describes differential peak calling in ATAC-Seq data
using `macs2`.


### Overview of the program

The goal is to identify differential regions (regions showing different
intensity/coverage) betwee two conditions. This will be done using fuction
`bdgdiff` from ``macs2` toolkit. Note that `macs2 diffpeak` is not
implemented yet.

Peak calling using `macs2 callpeaks` should have been run prior to this
analysis. Among the results files generated by `macs2 callpeks` we are
interested in two files -- the file containing the background signal
(*control_lambda.bdg*) and the file containing the signal of the actual
sample (*treat_pileup.bdg*).

The analysis described here was performed on two skin samples, psoriatic
lesional and non-lesional skin; and two monocyte samples, a publicly available
from Greenleaf lab and generated in-house. Standard ATAC protocol was followed by
sequencing on Illumina MiSeq for all in-house generated samples.

### Parameters of *macs2 bdgdiff*

The following parameters were considered for examination:

-  `--cutoff`, logLR cutoff. This is the log likelyhood ratio and is 2 by
   default, which means that likelihood ratio equals 1000. This parameter was
nt changed.
- `--min-len`, minimum length of differential region. This parameter was set to
  10, 50, 75, 100, 125, 150, 175, 200.
- `--max-gap`, maximum gap to merge nearby differential regions. This parameter
  was not changed. (default is 100).
- `--depth1` and `--depth2`, sequencing depth of the two samples. These two
  parameters are used to calculate scaling factor for each sample and normalize
  the data. First, we used the default `--depth1 1` and `--depth2 1`. Then, in
  order to see the effect of normalization/scaling, based on the number of reads
  mapped to peaks we set `--depth1 790330` (number of reads mapped to peaks in
  lesional skin) and `--depth2 943409` (number of reads mapped to peaks in
  non-lesional skip).

### Results: statistics

In the table below the overlap (number of common peaks) between jknight monocytes
and lesional skin / greenleaf monocytes is shown when using different minimal required
overlap between two peaks to be selected. The column names stand for:

- GM -- monocytes generated in Greenleaf lab, not scaled/normalized to the number of reads
  in peaks
- GMS -- monocytes generated in Greenleaf lab, scaled to the number of reads in peaks
- GMS_% -- percent of peaks in overlap from the total number of peaks detected for
  the Greenleaf monocytes
- LS -- lesional skin, not scaled/normalized to the number of reads
  in peaks
- GMS -- lesional skin, scaled to the number of reads in peaks
- GMS_% -- percent of peaks in overlap from the total number of peaks detected for
  lesional skin


| minlength  | GM   | GMS  | GMS_% | LS  | LSS | LSS_% |
| ---------- | ---- | ---- | ----- | --- | --- | ----- |
| minlen 10  | 3137 | 2691 | 7.32  | 474 | 372 | 1.03  |
| minlen 50  | 2918 | 2519 | 6.85  | 380 | 323 | 0.89  |
| minlen 75  | 2735 | 2368 | 6.44  | 319 | 286 | 0.79  |
| minlen 100 | 2552 | 2212 | 6.02  | 259 | 260 | 0.72  |
| minlen 125 | 2370 | 2041 | 5.55  | 216 | 221 | 0.61  |
| minlen 150 | 2153 | 1838 | 5.00  | 176 | 182 | 0.50  |
| minlen 175 | 1904 | 1609 | 4.38  | 139 | 157 | 0.43  |
| minlen 200 | 1585 | 1353 | 3.68  | 99  | 124 | 0.34  |

### Results: examples


### Future tasks


